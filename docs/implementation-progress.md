# SRM åç«¯å®æ–½è¿›åº¦æŠ¥å‘Š
<!--
  æ›´æ–°æ—¶é—´: 2026-02-09
  å½“å‰çŠ¶æ€: Phase 1 å®Œæˆï¼ŒPhase 2 è¿›è¡Œä¸­
-->

## æ¦‚è¿°

æœ¬æ–‡æ¡£è®°å½• SRM ç³»ç»Ÿä» mock æ•°æ®è¿ç§»åˆ° Supabase åç«¯çš„å®æ–½è¿›åº¦ã€‚

---

## å·²å®Œæˆå·¥ä½œ âœ…

### Phase 1: Supabase é¡¹ç›®è®¾ç½®å’Œæ•°æ®åº“åˆå§‹åŒ–

#### 1.1 é¡¹ç›®è¿æ¥
- **çŠ¶æ€**: âœ… å®Œæˆ
- **å†…å®¹**:
  - Supabase é¡¹ç›® URL: `https://tdrbuwshyebmjqljggww.supabase.co`
  - å·²é…ç½®è®¤è¯å¹¶æˆæƒ MCP è®¿é—®
  - è·å–å¯å‘å¸ƒå¯†é’¥

#### 1.2 æ•°æ®åº“è¿ç§»
- **çŠ¶æ€**: âœ… å®Œæˆ
- **å†…å®¹**: 11 ä¸ªè¿ç§»æ–‡ä»¶å…¨éƒ¨åº”ç”¨æˆåŠŸ
  1. `enable_extensions_and_create_suppliers` - æ‰©å±•å’Œä¾›åº”å•†ä¸»è¡¨
  2. `create_business_lines_tables` - ä¸šåŠ¡çº¿è¡¨
  3. `create_decision_chain_tables` - å†³ç­–é“¾è¡¨
  4. `create_engagement_logs_table` - äº’åŠ¨æ—¥å¿—è¡¨
  5. `create_performance_tables` - ç»©æ•ˆè¡¨
  6. `create_tasks_table` - ä»»åŠ¡è¡¨
  7. `create_risk_and_probation_tables` - é£é™©å’Œè€ƒå¯Ÿä»»åŠ¡è¡¨
  8. `create_calendar_lifecycle_audit_tables` - æ—¥å†/ç”Ÿå‘½å‘¨æœŸ/å®¡è®¡è¡¨
  9. `create_triggers_and_view` - è§¦å‘å™¨å’Œè§†å›¾
  10. `enable_rls_policies` - RLS ç­–ç•¥
  11. å…¶ä»–è¿ç§»

#### 1.3 æ•°æ®åº“è¡¨ç»“æ„
- **çŠ¶æ€**: âœ… å®Œæˆ
- **åˆ›å»ºçš„è¡¨**: 15 ä¸ªæ ¸å¿ƒè¡¨
  - `suppliers` - ä¾›åº”å•†ä¸»è¡¨
  - `business_lines` - ä¸šåŠ¡çº¿è¡¨
  - `business_line_contacts` - ä¸šåŠ¡çº¿è”ç³»äºº
  - `decision_chain` - å†³ç­–é“¾æˆå‘˜
  - `decision_chain_resources` - å†³ç­–é“¾å…³è”èµ„æº
  - `engagement_logs` - äº’åŠ¨æ—¥å¿—
  - `performance_history` - ç»©æ•ˆå†å²
  - `performance_dimensions` - ç»©æ•ˆé…ç½®ç»´åº¦
  - `tasks` - ä»»åŠ¡è¡¨
  - `risk_alerts` - é£é™©é¢„è­¦
  - `probation_tasks` - è€ƒå¯Ÿä»»åŠ¡
  - `calendar_events` - æ—¥å†äº‹ä»¶
  - `system_settings` - ç³»ç»Ÿé…ç½®
  - `lifecycle_events` - ç”Ÿå‘½å‘¨æœŸäº‹ä»¶
  - `audit_logs` - æ“ä½œå®¡è®¡

### Phase 2: å‰ç«¯åŸºç¡€è®¾æ–½

#### 2.1 ä¾èµ–å®‰è£…
- **çŠ¶æ€**: âœ… å®Œæˆ
- **å®‰è£…çš„åŒ…**:
  - `@supabase/supabase-js@^2.95.3`
  - `@tanstack/react-query@^5.90.20`

#### 2.2 TypeScript ç±»å‹å®šä¹‰
- **çŠ¶æ€**: âœ… å®Œæˆ
- **æ–‡ä»¶**: `src/types/database.ts`
- **å†…å®¹**:
  - Database ç±»å‹å®šä¹‰
  - æ‰€æœ‰è¡¨çš„ Row/Insert/Update ç±»å‹
  - ä¾¿æ·ç±»å‹å¯¼å‡ºï¼ˆSupplier, DecisionChain ç­‰ï¼‰
  - æšä¸¾ç±»å‹ï¼ˆSupplierTier, LogStatus ç­‰ï¼‰

#### 2.3 Supabase å®¢æˆ·ç«¯é…ç½®
- **çŠ¶æ€**: âœ… å®Œæˆ
- **æ–‡ä»¶**: `src/lib/supabase.ts`
- **åŠŸèƒ½**:
  - Supabase å®¢æˆ·ç«¯å•ä¾‹
  - é”™è¯¯å¤„ç†è¾…åŠ©å‡½æ•°
  - ç±»å‹å®‰å…¨çš„å®¢æˆ·ç«¯

#### 2.4 React Query é…ç½®
- **çŠ¶æ€**: âœ… å®Œæˆ
- **æ–‡ä»¶**: `src/lib/queryClient.tsx`
- **åŠŸèƒ½**:
  - QueryClient é…ç½®
  - Providers ç»„ä»¶
  - å¼€å‘å·¥å…·é›†æˆ
- **æ›´æ–°**: `src/main.tsx` å·²æ›´æ–°ä¸ºä½¿ç”¨ Providers

### Phase 3: æœåŠ¡å±‚å¼€å‘

- **çŠ¶æ€**: âœ… å®Œæˆ
- **æ–‡ä»¶**:
  - `src/services/suppliers.ts` - ä¾›åº”å•†æœåŠ¡
  - `src/services/decisionChain.ts` - å†³ç­–é“¾æœåŠ¡
  - `src/services/engagementLogs.ts` - äº’åŠ¨æ—¥å¿—æœåŠ¡
  - `src/services/businessLines.ts` - ä¸šåŠ¡çº¿æœåŠ¡
  - `src/services/performanceHistory.ts` - ç»©æ•ˆå†å²æœåŠ¡
  - `src/services/tasks.ts` - ä»»åŠ¡æœåŠ¡
  - `src/services/index.ts` - ç»Ÿä¸€å¯¼å‡º

### Phase 4: React Query Hooks

- **çŠ¶æ€**: âœ… å®Œæˆ
- **æ–‡ä»¶**:
  - `src/hooks/useSuppliers.ts` - ä¾›åº”å•† hooks
  - `src/hooks/useDecisionChain.ts` - å†³ç­–é“¾ hooks
  - `src/hooks/useEngagementLogs.ts` - äº’åŠ¨æ—¥å¿— hooks

### Phase 5: é¡µé¢æ”¹é€ 

#### 5.1 SupplierList é¡µé¢
- **çŠ¶æ€**: âœ… å®Œæˆ
- **æ–‡ä»¶**: `src/pages/SupplierList.tsx`ï¼ˆåŸæ–‡ä»¶å·²å¤‡ä»½ä¸º `.backup`ï¼‰
- **æ”¹åŠ¨**:
  - ç§»é™¤ mock æ•°æ®
  - ä½¿ç”¨ `useSuppliersSummary` hook
  - ä½¿ç”¨ `useCreateSupplier` mutation
  - ä½¿ç”¨ `useUpdateSupplier` mutation
  - æ·»åŠ åŠ è½½çŠ¶æ€
  - æ·»åŠ é”™è¯¯å¤„ç†
  - é€‚é…æ•°æ®åº“å­—æ®µç»“æ„

#### 5.2 CreateSupplierModal ç»„ä»¶
- **çŠ¶æ€**: âœ… å®Œæˆï¼ˆé€‚é…ï¼‰
- **è¯´æ˜**: ç°æœ‰ç»„ä»¶å·²å¯å·¥ä½œï¼Œéœ€åœ¨æäº¤æ—¶é€‚é…æ–°æ•°æ®ç»“æ„

---

## å¾…å®Œæˆå·¥ä½œ ğŸ“‹

### Phase 6: æ›´å¤šé¡µé¢æ”¹é€ 

#### 6.1 SupplierDetail é¡µé¢ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
- **çŠ¶æ€**: â³ å¾…å¼€å§‹
- **å¤æ‚åº¦**: é«˜ï¼ˆ3130 è¡Œï¼Œæœ€å¤æ‚çš„é¡µé¢ï¼‰
- **éœ€è¦çš„æ•°æ®**:
  - ä¾›åº”å•†è¯¦æƒ…
  - ä¸šåŠ¡çº¿åˆ—è¡¨
  - å†³ç­–é“¾æˆå‘˜
  - äº’åŠ¨æ—¥å¿—
  - ç»©æ•ˆå†å²
- **æ­¥éª¤**:
  1. ä½¿ç”¨ `useSupplierDetail` hook
  2. ä½¿ç”¨å„ä¸ªæœåŠ¡çš„ hooks
  3. æ·»åŠ åŠ è½½éª¨æ¶å±
  4. å¤„ç†æ ‡ç­¾é¡µåˆ‡æ¢

#### 6.2 SystemSettings é¡µé¢
- **çŠ¶æ€**: â³ å¾…å¼€å§‹
- **å¤æ‚åº¦**: ä¸­é«˜
- **åŠŸèƒ½**:
  - è´¢åŠ¡é…ç½®æ›´æ–°
  - é—¨æˆ·æƒé™æ›´æ–°
  - åˆ†çº§ç®¡ç†
  - ç»©æ•ˆé…ç½®

#### 6.3 PerformanceAppraisal é¡µé¢
- **çŠ¶æ€**: â³ å¾…å¼€å§‹
- **åŠŸèƒ½**:
  - ç»©æ•ˆè¯„ä¼°
  - é»‘åå•æµç¨‹ï¼ˆç†”æ–­ä¿æŠ¤ï¼‰
  - çº¢é»„çº¿æœºåˆ¶

#### 6.4 LifecycleManagement é¡µé¢
- **çŠ¶æ€**: â³ å¾…å¼€å§‹
- **åŠŸèƒ½**:
  - Kanban çœ‹æ¿
  - çŠ¶æ€æ‹–æ‹½

#### 6.5 Dashboard é¡µé¢
- **çŠ¶æ€**: â³ å¾…å¼€å§‹
- **åŠŸèƒ½**:
  - æ•°æ®èšåˆ
  - å›¾è¡¨å±•ç¤º
  - ä»»åŠ¡ç®¡ç†

### Phase 7: åŠŸèƒ½å¢å¼º

#### 7.1 Realtime è®¢é˜…
- å†³ç­–é“¾å˜æ›´é€šçŸ¥
- ä»»åŠ¡çŠ¶æ€å˜æ›´
- ä¾›åº”å•†çŠ¶æ€å˜æ›´

#### 7.2 é”™è¯¯å¤„ç†å®Œå–„
- å…¨å±€é”™è¯¯è¾¹ç•Œ
- å‹å¥½é”™è¯¯æç¤º
- é‡è¯•æœºåˆ¶

#### 7.3 ç¦»çº¿æ”¯æŒ
- ç¼“å­˜ç­–ç•¥ä¼˜åŒ–
- ç¦»çº¿æç¤º

---

## å…³é”®è®¾è®¡å†³ç­–

### 1. çŠ¶æ€ç®¡ç†
- **é€‰æ‹©**: React Query æœåŠ¡ç«¯çŠ¶æ€ + ç»„ä»¶çº§æœ¬åœ°çŠ¶æ€
- **åŸå› **:
  - ä¿æŒç°æœ‰ä»£ç ç»“æ„
  - React Query æä¾›è‡ªåŠ¨ç¼“å­˜ã€é‡æ–°éªŒè¯
  - æ— éœ€å¼•å…¥ Redux/Zustand

### 2. æ•°æ®è·å–ç­–ç•¥
- **é€‰æ‹©**: ä½¿ç”¨ React Query hooks å°è£…æœåŠ¡å±‚
- **åŸå› **:
  - é›†ä¸­ç®¡ç†æ•°æ®è·å–é€»è¾‘
  - è‡ªåŠ¨å¤„ç†åŠ è½½/é”™è¯¯çŠ¶æ€
  - ç±»å‹å®‰å…¨

### 3. é”™è¯¯å¤„ç†
- **ç­–ç•¥**:
  - æœåŠ¡å±‚ç»Ÿä¸€é”™è¯¯å¤„ç†
  - ç»„ä»¶å±‚æ˜¾ç¤ºå‹å¥½æç¤º
  - ä½¿ç”¨ try-catch å¤„ç† mutation

### 4. ç±»å‹å®‰å…¨
- **é€‰æ‹©**: å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- **åŸå› **:
  - ä¸å‰ç«¯ç°æœ‰ä»£ç ä¿æŒä¸€è‡´
  - æ•°æ®åº“ç”Ÿæˆç±»å‹
  - å‡å°‘è¿è¡Œæ—¶é”™è¯¯

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯æ‰§è¡Œ
1. æµ‹è¯• SupplierList é¡µé¢æ˜¯å¦æ­£å¸¸å·¥ä½œ
2. æ’å…¥ä¸€äº›æµ‹è¯•æ•°æ®åˆ°æ•°æ®åº“
3. éªŒè¯åˆ›å»ºä¾›åº”å•†åŠŸèƒ½

### çŸ­æœŸè®¡åˆ’
1. æ”¹é€  SupplierDetail é¡µé¢ï¼ˆæœ€å¤æ‚ï¼‰
2. æ”¹é€  SystemSettings é¡µé¢
3. æ”¹é€  PerformanceAppraisal é¡µé¢

### é•¿æœŸè®¡åˆ’
1. å®ç°æ‰€æœ‰é¡µé¢çš„åç«¯é›†æˆ
2. æ·»åŠ è®¤è¯/æˆæƒ
3. å®ç° Realtime åŠŸèƒ½
4. æ€§èƒ½ä¼˜åŒ–

---

## æŠ€æœ¯æ ˆæ€»ç»“

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| æ•°æ®åº“ | Supabase (PostgreSQL 15+) |
| åç«¯ API | Supabase REST API |
| å‰ç«¯æ¡†æ¶ | React 19.2.0 + TypeScript 5.9.3 |
| çŠ¶æ€ç®¡ç† | React Query 5.90.20 |
| è·¯ç”± | React Router DOM 7.13.0 |
| æ ·å¼ | Tailwind CSS 3.4.17 |
| æ„å»ºå·¥å…· | Vite 7.2.4 |

---

## æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
```
D:\SRM\
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ database.ts          # æ•°æ®åº“ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ supabase.ts          # Supabase å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ queryClient.tsx      # React Query é…ç½®
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ suppliers.ts         # ä¾›åº”å•†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ decisionChain.ts    # å†³ç­–é“¾æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ engagementLogs.ts   # äº’åŠ¨æ—¥å¿—æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ businessLines.ts    # ä¸šåŠ¡çº¿æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ performanceHistory.ts # ç»©æ•ˆå†å²æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ tasks.ts            # ä»»åŠ¡æœåŠ¡
â”‚   â”‚   â””â”€â”€ index.ts            # æœåŠ¡å¯¼å‡º
â”‚   â””â”€â”€ hooks/
â”‚       â”œâ”€â”€ useSuppliers.ts      # ä¾›åº”å•† hooks
â”‚       â”œâ”€â”€ useDecisionChain.ts # å†³ç­–é“¾ hooks
â”‚       â””â”€â”€ useEngagementLogs.ts # äº’åŠ¨æ—¥å¿— hooks
â”œâ”€â”€ .env.local.example          # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ task_plan-implementation.md # å®æ–½ä»»åŠ¡è®¡åˆ’
```

### ä¿®æ”¹æ–‡ä»¶
```
src/
â”œâ”€â”€ main.tsx                    # æ·»åŠ  Providers
â””â”€â”€ pages/
    â”œâ”€â”€ SupplierList.tsx        # æ”¹é€ ä¸ºä½¿ç”¨çœŸå® API
    â””â”€â”€ SupplierList.tsx.backup # åŸæ–‡ä»¶å¤‡ä»½
```

### æ•°æ®åº“æ–‡ä»¶
```
database/
â”œâ”€â”€ schema.sql                  # å®Œæ•´æ•°æ®åº“ Schema
â”œâ”€â”€ er-diagram.md               # ER å›¾è¯´æ˜
â””â”€â”€ api-design.md               # API æ¥å£æ–‡æ¡£
```

---

## æµ‹è¯•æ­¥éª¤

### 1. éªŒè¯æ•°æ®åº“è¿æ¥
```bash
npm run dev
```
è®¿é—®åº”ç”¨ï¼ŒæŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

### 2. æµ‹è¯• SupplierList é¡µé¢
- æ‰“å¼€ http://localhost:5173/#/supplier-profile
- æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºåŠ è½½çŠ¶æ€
- æ£€æŸ¥æ˜¯å¦æ˜¾ç¤º"æš‚æ— ä¾›åº”å•†æ•°æ®"

### 3. æ’å…¥æµ‹è¯•æ•°æ®
ä½¿ç”¨ Supabase Dashboard çš„ Table Editor æ’å…¥ä¸€äº›æµ‹è¯•æ•°æ®

### 4. æµ‹è¯•åˆ›å»ºä¾›åº”å•†
- ç‚¹å‡»"æ–°å»ºæ¡£æ¡ˆ"æŒ‰é’®
- å¡«å†™è¡¨å•å¹¶æäº¤
- éªŒè¯æ˜¯å¦æˆåŠŸåˆ›å»º

---

## é—®é¢˜æ’æŸ¥

### å¦‚æœé‡åˆ°è¿æ¥é—®é¢˜
1. æ£€æŸ¥ `.env.local` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
2. æ£€æŸ¥ Supabase é¡¹ç›® URL å’Œå¯†é’¥æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

### å¦‚æœé‡åˆ°ç±»å‹é”™è¯¯
1. ç¡®ä¿ `@supabase/supabase-js` å’Œ `@tanstack/react-query` å·²å®‰è£…
2. è¿è¡Œ `npm run lint` æ£€æŸ¥ç±»å‹é”™è¯¯

### å¦‚æœé¡µé¢æ— æ³•æ˜¾ç¤º
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. æ£€æŸ¥ Network é¢æ¿æŸ¥çœ‹ API è¯·æ±‚
3. ç¡®è®¤æ•°æ®åº“è¡¨å·²åˆ›å»º

---

**æœ€åæ›´æ–°**: 2026-02-09
**ä¸‹æ¬¡æ›´æ–°**: å®Œæˆ SupplierDetail é¡µé¢æ”¹é€ å
